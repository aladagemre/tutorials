<!DOCTYPE HTML>

<html lang="en-us">

<head>
	<meta charset="utf-8">
	<title>Running Play Apps via Docker - Tutorials by Ahmet Emre Aladağ</title>
	<meta name="author" content="map[email:aladagemre@gmail.com website:http://www.emrealadag.com name:Ahmet Emre Aladağ]">

	
	
	<meta name="description" content="">
	

	
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    
	<link href='/index.xml' rel="alternate" title="Tutorials by Ahmet Emre Aladağ" type="application/atom+xml">
	
	<link rel="canonical" href="http://tuts.emrealadag.com/post/running-play-apps-via-docker/">
	<link href="http://tuts.emrealadag.com/favicon.png" rel="shortcut icon">
	<link href="http://tuts.emrealadag.com/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="http://tuts.emrealadag.com/css/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-2553826-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	
	<script src="http://tuts.emrealadag.com/js/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5('aladagemre@gmail.com') + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
	
	
</div>

<nav id="main-nav"><ul class="main">
    <li><a href="http://tuts.emrealadag.com/">Tutorial Home</a></li>
    <li><a href="http://www.emrealadag.com">Personal Site</a></li>
    <li><a href="http://tuts.emrealadag.com/post/">Archives</a></li>
</ul>


<section class="aboutme">
  <p>
    Tutorials by Ahmet Emre Aladağ.
  </p>
</section>

</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
			<a class="google" href='https://plus.google.com/ahmetemrealadag' rel="author" title="Google+">Google+</a>
		
		
			<a class="twitter" href='http://twitter.com/aladagemre' title="Twitter">Twitter</a>
		
		
			<a class="github" href='https://github.com/aladagemre' title="GitHub">GitHub</a>
		
		
		
		
			<a class="linkedin" href='http://www.linkedin.com/in/ahmet-emre-aladag' title="LinkedIn">LinkedIn</a>
		
		
			<a class="pinterest" href='https://pinterest.com/aladagemre' title="Pinterest">Pinterest</a>
		
		
		
		
		
			<a class="quora" href='https://quora.com/aladagemre' title="Quora">Quora</a>
		
		
			<a class="instagram" href='https://instagram.com/aladag.emre' title="Instagram">Instagram</a>
		
    	
    	
			<a class="rss" href='/index.xml' title="RSS">RSS</a>
		
	</div>
</nav>
<link rel="stylesheet" href="https://yandex.st/highlightjs/8.0/styles/default.min.css">
<script src="https://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</header>
			</div>
		</div>
		<div class="mid-col">
			
			<div class="mid-col-container">
				<div id="content" class="inner">
					<div itemscope itemtype="http://schema.org/Blog">
					<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <h1 class="title" itemprop="name">Running Play Apps via Docker</h1>
	<div class="entry-content" itemprop="articleBody">
        

<p>In this tutorial, I will guide you running your Play framework application (named MyProject in our tutorial) via Docker. I assume you have created a Play project with a build.sbt (or equivalent) file and make sure it&rsquo;s running on port 9000 with sbt run command.</p>

<p>Our demo project pulls tweets from Twitter of a specified person so it requires environment variables <em>CONSUMER_KEY, CONSUMER_SECRET, ACCESS_TOKEN, ACCESS_TOKEN_SECRET</em> to be set before running.</p>

<h2 id="docker-installation:3ed2385a48282d0dcf272bc98aec98c2">Docker Installation</h2>

<p>Make sure you have installed the latest version of Docker Toolbox. In order to use docker command, Docker needs some environment variables to be set. To do this, Docker introduces Docker QuickStart Terminal.</p>

<p>Run Docker Quickstart Terminal from Launchpad. A new terminal tab will open either on Terminal or iTerm app (depending on which one you chose at the installation). Check if any docker containers exist:</p>

<pre><code>$ docker ps -a
</code></pre>

<p>Now lets check the DOCKER_HOST (we will use this IP instead of localhost when reaching the app).</p>

<pre><code>$ echo $DOCKER_HOST
</code></pre>

<p>You will see something like tcp://192.168.99.100:2376. This means we will use IP address 192.168.99.100 for reaching our apps.</p>

<h2 id="building-docker-image-with-sbt:3ed2385a48282d0dcf272bc98aec98c2">Building Docker Image with SBT</h2>

<p>Now that we have Docker installed and running, we can build a Docker image for our Play App. We can use SBT Native Packager plugin&rsquo;s docker feature to build a Docker image for the Play app (named MyProject). Before using the plugin, we have to add some config parameters to build.sbt of the Play project:</p>

<pre><code>dockerExposedPorts := Seq(9000, 9443)
dockerExposedVolumes := Seq(&quot;/opt/docker/logs&quot;)
</code></pre>

<p>This will add instructions to the Dockerfile to expose 9000 and 9443 ports and let us read logs outside the container. Then build the image:</p>

<pre><code>$ cd MyProject
$ sbt docker:publishLocal
</code></pre>

<p>Now check docker images:</p>

<pre><code>$ docker images
</code></pre>

<p>you will see a table listing all docker images available.</p>

<table>
<thead>
<tr>
<th>REPOSITORY</th>
<th>TAG</th>
<th>IMAGE ID</th>
<th>CREATED</th>
<th>VIRTUAL SIZE</th>
</tr>
</thead>

<tbody>
<tr>
<td>myproject</td>
<td>1.0-SNAPSHOT</td>
<td>cd25bf99efa9</td>
<td>2 minutes ago</td>
<td>925.8 MB</td>
</tr>

<tr>
<td>java</td>
<td>latest</td>
<td>7547e52aac4b</td>
<td>3 weeks ago</td>
<td>817.5 MB</td>
</tr>
</tbody>
</table>

<h2 id="creating-the-container:3ed2385a48282d0dcf272bc98aec98c2">Creating the Container</h2>

<p>We now see the image named myproject created for our app. Let&rsquo;s create a container with this image with environment variables and ports added.</p>

<pre><code>$ docker run --name MyProject -p 9000:9000 -e CONSUMER_KEY=abcd -e CONSUMER_SECRET=abcd -e ACCESS_TOKEN=abcd -e ACCESS_TOKEN_SECRET=abcd myproject:1.0-SNAPSHOT
</code></pre>

<p>This command means:</p>

<ul>
<li>use myproject image with 1.0-SNAPSHOT tag.</li>
<li>expose port 9000 (right one) of inner Play app to 9000 (left one) of the outer system.</li>
<li>name the container as myproject.</li>
<li>give environment variables CONSUMER_KEY, CONSUMER_SECRET&hellip; with -e parameter for each.</li>
</ul>

<p>Console will show logs for the app and navigate to <a href="http://192.168.99.100:9000">http://192.168.99.100:9000</a> (the DOCKER_HOST) to reach the app. You can stop the container with Ctrl/CMD+C.</p>

<h2 id="restarting-the-container:3ed2385a48282d0dcf272bc98aec98c2">Restarting the Container</h2>

<pre><code>$ docker ps -a
</code></pre>

<p>you will see the container has exited.</p>

<table>
<thead>
<tr>
<th align="left">CONTAINER ID</th>
<th align="left">IMAGE</th>
<th align="left">COMMAND</th>
<th align="left">CREATED</th>
<th align="left">STATUS</th>
<th align="left">PORTS</th>
<th align="left">NAMES</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">c9b768dac51e</td>
<td align="left">myproject:1.0-SNAPSHOT</td>
<td align="left">&ldquo;bin/myproject&rdquo;</td>
<td align="left">10 minutes ago</td>
<td align="left">Exited (130) 30 seconds ago</td>
<td align="left"></td>
<td align="left">MyProject</td>
</tr>
</tbody>
</table>

<p>Now restart the container (initials of the id is sufficient):</p>

<pre><code>$ docker start c9b
$ docker ps -a
</code></pre>

<p>And we see the running containers:</p>

<table>
<thead>
<tr>
<th>CONTAINER ID</th>
<th>IMAGE</th>
<th>COMMAND</th>
<th>CREATED</th>
<th>STATUS</th>
<th>PORTS</th>
<th>NAMES</th>
</tr>
</thead>

<tbody>
<tr>
<td>c9b768dac51e</td>
<td>myproject:1.0-SNAPSHOT</td>
<td>&ldquo;bin/myproject&rdquo;</td>
<td>11 minutes ago</td>
<td>Up 13 seconds</td>
<td>0.0.0.0:9000-&gt;9000/tcp, 9443/tcp</td>
<td>MyProject</td>
</tr>
</tbody>
</table>

<h2 id="stopping-the-container:3ed2385a48282d0dcf272bc98aec98c2">Stopping the Container</h2>

<p>When you restart the container, it will run in the deamon mode. you can stop it via:</p>

<pre><code>$ docker stop c9b
</code></pre>

<p>We&rsquo;re done!</p>

        
        <p style="margin-bottom: 0">
           <a href="https://twitter.com/aladagemre" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @aladagemre</a>
           <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </p>
        
    </div>
</article>
					
						<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_button_google_plusone" g:plusone:size=''></a>
	
	
	</div>
	
  	<script type="text/javascript" src='http://s7.addthis.com/js/250/addthis_widget.js#pubid='></script>
  	
</div>

					
					
					<section id="comment">
					    <h1 class="title">Comments</h1>
					    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
					</section>
					
					

<script type="text/javascript">
    
    var disqus_shortname = 'emrealadag';

    
    

    
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
    
</script>


				    </div>
				</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2016

    Ahmet Emre Aladağ

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
<script src="http://tuts.emrealadag.com/js/slash.js"></script>
<script src="http://tuts.emrealadag.com/js/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script></footer>
		</div>
	</div>
	
</body>
</html>
